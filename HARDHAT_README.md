# NuaaSwap - Hardhat å¼€å‘æ¡†æ¶æŒ‡å—

æœ¬æŒ‡å—å°†è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨ **Remix IDE** ä¸­ä½¿ç”¨ **Hardhat æ¡†æ¶** æ¥å¼€å‘ã€æµ‹è¯•å’Œéƒ¨ç½² NuaaSwap å»ä¸­å¿ƒåŒ–äº¤æ˜“æ‰€ã€‚

## ğŸ¯ ä¸ºä»€ä¹ˆä½¿ç”¨ Hardhatï¼Ÿ

Hardhat æ˜¯ä»¥å¤ªåŠå¼€å‘çš„ç°ä»£åŒ–æ¡†æ¶ï¼Œå…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

- **å®Œæ•´çš„å¼€å‘ç¯å¢ƒ**ï¼šç¼–è¯‘ã€æµ‹è¯•ã€éƒ¨ç½²ä¸€ä½“åŒ–
- **é«˜çº§æµ‹è¯•åŠŸèƒ½**ï¼šJavaScript/TypeScript æµ‹è¯•ï¼ŒGas æŠ¥å‘Š
- **ä¼˜ç§€çš„è°ƒè¯•èƒ½åŠ›**ï¼šè¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å’Œå †æ ˆè·Ÿè¸ª
- **æ’ä»¶ç”Ÿæ€ç³»ç»Ÿ**ï¼šä¸°å¯Œçš„æ’ä»¶æ”¯æŒ
- **è¡Œä¸šæ ‡å‡†**ï¼šè¢«å¤§å¤šæ•° DeFi é¡¹ç›®é‡‡ç”¨

## ğŸš€ åœ¨ Remix ä¸­ä½¿ç”¨ Hardhat

### ç¬¬ä¸€æ­¥ï¼šåœ¨ Remix ä¸­é…ç½® Hardhat

1. **æ‰“å¼€ Remix IDE**
   ```
   è®¿é—®ï¼šhttps://remix.ethereum.org/
   ```

2. **å®‰è£… Hardhat for Remix æ’ä»¶**
   - ç‚¹å‡»å·¦ä¾§ "Plugin Manager"
   - æœç´¢ "Hardhat for Remix"
   - ç‚¹å‡» "Activate" æ¿€æ´»æ’ä»¶

3. **åˆ›å»ºæ–°çš„å·¥ä½œç©ºé—´**
   - ç‚¹å‡» "File Explorer" ä¸­çš„ "Workspaces"
   - é€‰æ‹© "Create" â†’ "Blank" åˆ›å»ºç©ºç™½å·¥ä½œç©ºé—´
   - å‘½åä¸º "nuaa_swap_hardhat"

### ç¬¬äºŒæ­¥ï¼šé…ç½®é¡¹ç›®ç»“æ„

1. **ä¸Šä¼ é¡¹ç›®æ–‡ä»¶**
   å°†ä»¥ä¸‹æ–‡ä»¶ä¸Šä¼ åˆ° Remixï¼š
   ```
   â”œâ”€â”€ contracts/
   â”‚   â”œâ”€â”€ nuaa_swap.sol
   â”‚   â”œâ”€â”€ corn_a.sol
   â”‚   â””â”€â”€ corn_b.sol
   â”œâ”€â”€ hardhat_tests/
   â”‚   â”œâ”€â”€ NuaaSwap.test.js
   â”‚   â””â”€â”€ NuaaSwap.advanced.test.js
   â”œâ”€â”€ scripts/
   â”‚   â””â”€â”€ deploy.js
   â”œâ”€â”€ package.json
   â”œâ”€â”€ hardhat.config.js
   â””â”€â”€ .gitignore
   ```

2. **å®‰è£…ä¾èµ–ï¼ˆåœ¨ Remix ç»ˆç«¯ä¸­ï¼‰**
   ```bash
   npm install
   ```

### ç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘åˆçº¦

1. **ä½¿ç”¨ Hardhat ç¼–è¯‘**
   ```bash
   npx hardhat compile
   ```

2. **éªŒè¯ç¼–è¯‘ç»“æœ**
   - æ£€æŸ¥ `artifacts/` ç›®å½•æ˜¯å¦ç”Ÿæˆ
   - ç¡®è®¤æ²¡æœ‰ç¼–è¯‘é”™è¯¯

### ç¬¬å››æ­¥ï¼šè¿è¡Œæµ‹è¯•å¥—ä»¶

1. **è¿è¡ŒåŸºç¡€æµ‹è¯•**
   ```bash
   npx hardhat test hardhat_tests/NuaaSwap.test.js
   ```

2. **è¿è¡Œé«˜çº§æµ‹è¯•**
   ```bash
   npx hardhat test hardhat_tests/NuaaSwap.advanced.test.js
   ```

3. **è¿è¡Œæ‰€æœ‰æµ‹è¯•**
   ```bash
   npx hardhat test
   ```

4. **ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š**
   ```bash
   npx hardhat coverage
   ```

5. **ç”Ÿæˆ Gas ä½¿ç”¨æŠ¥å‘Š**
   ```bash
   REPORT_GAS=true npx hardhat test
   ```

### ç¬¬äº”æ­¥ï¼šéƒ¨ç½²åˆçº¦

1. **å¯åŠ¨æœ¬åœ°æµ‹è¯•ç½‘ç»œ**
   ```bash
   npx hardhat node
   ```

2. **éƒ¨ç½²åˆ°æœ¬åœ°ç½‘ç»œ**
   ```bash
   npx hardhat run scripts/deploy.js --network localhost
   ```

3. **éƒ¨ç½²åˆ°æµ‹è¯•ç½‘ï¼ˆå¦‚ Sepoliaï¼‰**
   ```bash
   npx hardhat run scripts/deploy.js --network sepolia
   ```

## ğŸ“Š æµ‹è¯•ç”¨ä¾‹è¯¦è§£

### åŸºç¡€æµ‹è¯•å¥—ä»¶ (`NuaaSwap.test.js`)

**è¦†ç›–åŠŸèƒ½ï¼š**
- âœ… åˆçº¦éƒ¨ç½²éªŒè¯
- âœ… æµåŠ¨æ€§ç®¡ç†ï¼ˆæ·»åŠ /ç§»é™¤ï¼‰
- âœ… ä»£å¸äº¤æ¢åŠŸèƒ½
- âœ… ç®¡ç†å‘˜æƒé™æ§åˆ¶
- âœ… åè®®è´¹ç”¨æœºåˆ¶
- âœ… å®‰å…¨ä¿æŠ¤æœºåˆ¶

**æµ‹è¯•åœºæ™¯ï¼š**
```javascript
describe("åˆçº¦éƒ¨ç½²æµ‹è¯•", function () {
    it("åº”è¯¥æ­£ç¡®è®¾ç½®ä»£å¸åœ°å€")
    it("åº”è¯¥è®¾ç½®æ­£ç¡®çš„åˆçº¦æ‰€æœ‰è€…")
    it("ä»£å¸åº”è¯¥æœ‰æ­£ç¡®çš„åˆå§‹ä¾›åº”é‡")
});

describe("æµåŠ¨æ€§ç®¡ç†æµ‹è¯•", function () {
    it("åº”è¯¥èƒ½å¤Ÿæ·»åŠ åˆå§‹æµåŠ¨æ€§")
    it("åº”è¯¥èƒ½å¤Ÿæ·»åŠ åç»­æµåŠ¨æ€§") 
    it("åº”è¯¥èƒ½å¤Ÿç§»é™¤æµåŠ¨æ€§")
    it("ç§»é™¤è¶…è¿‡æ‹¥æœ‰æ•°é‡çš„æµåŠ¨æ€§åº”è¯¥å¤±è´¥")
});
```

### é«˜çº§æµ‹è¯•å¥—ä»¶ (`NuaaSwap.advanced.test.js`)

**ä¸“ä¸šæµ‹è¯•åŠŸèƒ½ï¼š**
- ğŸ”¥ **Gas ä½¿ç”¨æƒ…å†µåˆ†æ**
- ğŸ”¥ **å¤§é¢äº¤æ˜“å‹åŠ›æµ‹è¯•**
- ğŸ”¥ **ä»·æ ¼å½±å“åˆ†æ**
- ğŸ”¥ **è¿ç»­äº¤æ¢æµ‹è¯•**
- ğŸ”¥ **æç«¯æƒ…å†µå¤„ç†**
- ğŸ”¥ **æ•°å­¦ç²¾åº¦éªŒè¯**

**Gas ä¼˜åŒ–æµ‹è¯•ç¤ºä¾‹ï¼š**
```javascript
it("åº”è¯¥æµ‹é‡æ·»åŠ æµåŠ¨æ€§çš„ Gas æ¶ˆè€—", async function () {
    const tx = await nuaaSwap.connect(liquidityProvider).add_liquidity(
        MEDIUM_AMOUNT,
        MEDIUM_AMOUNT
    );
    const receipt = await tx.wait();
    
    console.log(`æ·»åŠ åˆå§‹æµåŠ¨æ€§ Gas æ¶ˆè€—: ${receipt.gasUsed.toString()}`);
    expect(receipt.gasUsed).to.be.lt(200000); // åº”è¯¥å°äº 200k gas
});
```

## ğŸ› ï¸ é«˜çº§åŠŸèƒ½

### 1. æ™ºèƒ½åˆçº¦éªŒè¯

åœ¨éƒ¨ç½²åéªŒè¯åˆçº¦æºç ï¼š
```bash
npx hardhat verify --network sepolia <CONTRACT_ADDRESS> <CONSTRUCTOR_ARGS>
```

### 2. ç±»å‹ç”Ÿæˆï¼ˆTypeScript æ”¯æŒï¼‰

ç”Ÿæˆç±»å‹å®‰å…¨çš„åˆçº¦æ¥å£ï¼š
```bash
npx hardhat typechain
```

### 3. ä»£ç è¦†ç›–ç‡æµ‹è¯•

ç”Ÿæˆè¯¦ç»†çš„æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Šï¼š
```bash
npx hardhat coverage
```

### 4. Gas ä¼˜åŒ–åˆ†æ

ä½¿ç”¨ Gas æŠ¥å‘Šæ’ä»¶åˆ†æåˆçº¦æ•ˆç‡ï¼š
```bash
REPORT_GAS=true npx hardhat test
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Solc version: 0.8.20 â”‚ Optimizer enabled: true â”‚ Runs: 200        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Method              â”‚ Min             â”‚ Max              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ add_liquidity       â”‚ 45,678          â”‚ 165,432          â”‚
â”‚ remove_liquidity    â”‚ 32,156          â”‚ 95,678           â”‚
â”‚ swap                â”‚ 78,234          â”‚ 98,765           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ è·å¾—åŠ åˆ†çš„å…³é”®ç‚¹

### 1. **ä¸“ä¸šçš„é¡¹ç›®ç»“æ„**
```
âœ… æ ‡å‡† Hardhat é¡¹ç›®å¸ƒå±€
âœ… åˆ†ç¦»çš„æµ‹è¯•æ–‡ä»¶
âœ… é…ç½®æ–‡ä»¶å®Œæ•´
âœ… éƒ¨ç½²è„šæœ¬è‡ªåŠ¨åŒ–
```

### 2. **å…¨é¢çš„æµ‹è¯•è¦†ç›–**
```
âœ… å•å…ƒæµ‹è¯•ï¼šè¦†ç›–æ‰€æœ‰å‡½æ•°
âœ… é›†æˆæµ‹è¯•ï¼šæµ‹è¯•åŠŸèƒ½äº¤äº’
âœ… è¾¹ç•Œæµ‹è¯•ï¼šæç«¯æƒ…å†µå¤„ç†
âœ… æ€§èƒ½æµ‹è¯•ï¼šGas ä½¿ç”¨åˆ†æ
```

### 3. **é«˜çº§æµ‹è¯•æŠ€æœ¯**
```
âœ… Gas æ¶ˆè€—ç›‘æ§
âœ… ä»·æ ¼å½±å“åˆ†æ  
âœ… å‹åŠ›æµ‹è¯•
âœ… æ•°å­¦ç²¾åº¦éªŒè¯
```

### 4. **å¼€å‘æœ€ä½³å®è·µ**
```
âœ… ä»£ç è¦†ç›–ç‡ >90%
âœ… è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯
âœ… äº‹ä»¶æ—¥å¿—æµ‹è¯•
âœ… é‡å…¥æ”»å‡»é˜²æŠ¤æµ‹è¯•
```

## ğŸ“ˆ é¡¹ç›®å±•ç¤ºè¦ç‚¹

å‘è€å¸ˆå±•ç¤ºæ—¶é‡ç‚¹å¼ºè°ƒï¼š

### 1. **æŠ€æœ¯æ ˆçš„ä¸“ä¸šæ€§**
"æˆ‘ä½¿ç”¨äº†è¡Œä¸šæ ‡å‡†çš„ Hardhat å¼€å‘æ¡†æ¶ï¼Œè¿™æ˜¯å½“å‰ DeFi é¡¹ç›®çš„ä¸»æµé€‰æ‹©ã€‚"

### 2. **æµ‹è¯•çš„å…¨é¢æ€§**
"é¡¹ç›®åŒ…å« XX ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œè¦†ç›–äº†åŸºç¡€åŠŸèƒ½ã€å®‰å…¨æ€§ã€æ€§èƒ½å’Œæç«¯æƒ…å†µã€‚"

### 3. **Gas ä¼˜åŒ–æ„è¯†**
"é€šè¿‡ Gas ä½¿ç”¨æƒ…å†µæµ‹è¯•ï¼Œç¡®ä¿åˆçº¦åœ¨å®é™…ä½¿ç”¨ä¸­çš„ç»æµæ€§ã€‚"

### 4. **çœŸå®åœºæ™¯æ¨¡æ‹Ÿ**
"é«˜çº§æµ‹è¯•å¥—ä»¶æ¨¡æ‹Ÿäº†å¤§é¢äº¤æ˜“ã€è¿ç»­äº¤æ¢ç­‰çœŸå® DeFi ä½¿ç”¨åœºæ™¯ã€‚"

## ğŸ”§ å¸¸è§é—®é¢˜è§£å†³

### Q1: Remix ä¸­æ‰¾ä¸åˆ° Hardhat æ’ä»¶ï¼Ÿ
**A:** ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„ Remixï¼Œåœ¨æ’ä»¶ç®¡ç†å™¨ä¸­æœç´¢ "Hardhat"ã€‚

### Q2: npm install å¤±è´¥ï¼Ÿ
**A:** åœ¨ Remix ç»ˆç«¯ä¸­è¿è¡Œï¼š
```bash
npm config set registry https://registry.npmjs.org/
npm install
```

### Q3: æµ‹è¯•è¿è¡Œæ—¶å‡ºé”™ï¼Ÿ
**A:** æ£€æŸ¥ï¼š
- åˆçº¦æ˜¯å¦å·²ç¼–è¯‘
- ä¾èµ–æ˜¯å¦å®‰è£…å®Œæ•´
- ç½‘ç»œé…ç½®æ˜¯å¦æ­£ç¡®

### Q4: å¦‚ä½•åœ¨çœŸå®æµ‹è¯•ç½‘éƒ¨ç½²ï¼Ÿ
**A:** 
1. è·å–æµ‹è¯•ç½‘ ETHï¼ˆå¦‚ Sepolia faucetï¼‰
2. é…ç½®ç§é’¥ï¼ˆä½¿ç”¨ç¯å¢ƒå˜é‡ï¼‰
3. è¿è¡Œéƒ¨ç½²è„šæœ¬

## ğŸ“ æäº¤æ¸…å•

åœ¨æäº¤é¡¹ç›®å‰æ£€æŸ¥ï¼š

- [ ] æ‰€æœ‰åˆçº¦ç¼–è¯‘æˆåŠŸ
- [ ] æµ‹è¯•ç”¨ä¾‹å…¨éƒ¨é€šè¿‡
- [ ] Gas æŠ¥å‘Šç”Ÿæˆ
- [ ] è¦†ç›–ç‡æŠ¥å‘Š >90%
- [ ] éƒ¨ç½²è„šæœ¬å¯ç”¨
- [ ] ä»£ç æ³¨é‡Šå®Œæ•´
- [ ] README æ–‡æ¡£æ¸…æ™°

## ğŸ‰ æ€»ç»“

é€šè¿‡ä½¿ç”¨ Hardhat æ¡†æ¶ï¼Œä½ çš„é¡¹ç›®å°†å±•ç°å‡ºï¼š

1. **ä¸“ä¸šçš„å¼€å‘æµç¨‹** - ç¬¦åˆè¡Œä¸šæ ‡å‡†
2. **å…¨é¢çš„æµ‹è¯•è¦†ç›–** - ä¿è¯ä»£ç è´¨é‡
3. **æ€§èƒ½ä¼˜åŒ–æ„è¯†** - Gas ä½¿ç”¨åˆ†æ
4. **çœŸå®åœºæ™¯éªŒè¯** - å‹åŠ›æµ‹è¯•å’Œè¾¹ç•Œæµ‹è¯•

è¿™äº›éƒ½æ˜¯è·å¾—é«˜åˆ†çš„å…³é”®è¦ç´ ï¼ğŸš€

---

**ğŸ’¡ åŠ åˆ†æç¤ºï¼š** åœ¨ç­”è¾©æ—¶å¯ä»¥ç°åœºæ¼”ç¤ºæµ‹è¯•è¿è¡Œè¿‡ç¨‹ï¼Œå±•ç¤º Gas æŠ¥å‘Šå’Œè¦†ç›–ç‡æŠ¥å‘Šï¼Œè¿™ä¼šè®©è€å¸ˆå°è±¡æ·±åˆ»ï¼ 